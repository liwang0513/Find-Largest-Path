I use Dynamic Programming to solve this problem. 

I maintained a list to store the information line by line. 

In summary, the time complexity is O(N) and the space complexity is O(logN).